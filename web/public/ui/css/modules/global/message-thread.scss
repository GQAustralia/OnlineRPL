$border-radius-post: $border-radius-base;

.message-thread {
	.message-thread-item {
		display: block;
		clear: both;
		@include clearfix();
		margin-bottom: 20px;
	}
	.message-thread-item-dropdown {
		position: absolute;
		top: 10px;
		right: 10px;

		.btn {
			$dim: 30px;
			padding: 0;
			text-align: center;
			width: $dim;
			height: $dim;
			border-radius: $dim;
			@include opacity(0.5);
		}
	}
	.message-avatar {
		float: left;
		position: relative;
	}
	.message-post {
		// $post-bg: lighten($gray-lighter,6%);
		$post-bg: white;
		$margin-left: 20px;
		float: left;
		position: relative;
		margin-left: $margin-left;
		background-color: $post-bg;
		border: 1px solid $gray-lighter;
		border-bottom: 1px solid darken($gray-lighter,4%);
		border-radius: $border-radius-post;
		padding: 20px 25px;
		padding-top: 30px;
		@include box-shadow(0 1px 2px 0 rgba(0,0,0,0.1));
		@include calc-sub-two-values(width, 100%, $avatar-xxs + $margin-left);
		.message-text {
			position: relative;
			display: block;
			clear: both;
		}
		.message-stamp {
			top: 5px;
			left: 0;
			right: 0;
			position: absolute;
			@include opacity(0);
			@include transition(opacity .3s $easing);
			text-align: center;
			color: $text-muted;
			display: block;
		}
		&:hover {
			.message-stamp, .message-thread-item-dropdown.open .btn { 
				@include opacity(1);
				@include transition(opacity .3s $easing);
			}
		}

		// Pointer
		$top-offset-pointer-base: 15px;
		$top-offset-pointer-bg: $top-offset-pointer-base + 1; 
		&:before, &:after {
			display: block;
			position: absolute;
			content: '';
			width: 0;
			height: 0;
			border: 0 solid transparent;
			border-top-width: 0px;
		}
		&:before {
			top: $top-offset-pointer-base;
			right: 100%;
			border-top-width: 0px;
			border-bottom-width: 15px;
			border-right: 15px solid $gray-lighter;
			z-index: 0;
		}
		&:after {
			top: $top-offset-pointer-bg;
			@include calc-sub-two-values(right, 100%, 1px);
			border-top-width: 0px;
			border-bottom-width: 13px;
			border-right: 13px solid $post-bg;
			z-index: 1;
		}
	}
	.message-post-footer-button {
		position: relative;
		display: block;
		margin: -25px;
		margin-top: 20px;
		margin-bottom: -21px;
		border-bottom: 1px solid #cecece;
		border-top: 1px solid lighten($gray-lighter,6%);
		background: lighten($gray-lighter,8%);
		border-bottom-left-radius: $border-radius-post - 2;
		border-bottom-right-radius: $border-radius-post - 2;
		padding: 5px;
		padding-left: 15px;
		overflow: hidden;
		min-height: 45px;

		.btn, label {
			position: absolute;
			left: 30px;
			outline: none !important;
		}

		.btn { padding-left: 0; top: 5px; @include opacity(1); @include transition(all .3s $easing);}
		label { top: 90px; @include opacity(0); @include transition(all .3s $easing);}

		.btn.acknowledged { top: -45px; @include opacity(0); @include transition(all .3s $easing); }
		.btn.acknowledged + label { top: 13px; @include opacity(1); @include transition(all .3s $easing); }
	}
	.message-input {
		display: block;
		clear: both;
		position: relative;
		border: 1px solid #e0e0e0;
		border-bottom: 1px solid #cecece;
		border-radius: $border-radius-base;
		@include clearfix();
		@include transition(box-shadow .3s $easing);
		@include box-shadow(0 1px 2px 0 rgba(0,0,0,0.1));

		&:hover {
			border: 1px solid darken($gray-lighter,10%);
			@include transition(box-shadow .3s $easing);
			@include box-shadow(0 1px 4px 0 rgba(0,0,0,0.2));			
		}
		textarea.form-control {
			position: relative;
			z-index: 0;
			border-radius: $border-radius-base;
			padding: 15px 30px 15px 15px;
		}
		.btn {
			position: absolute;
			right: 0;
			bottom: 0;
			height: 70px;
			z-index: 1;
		}
	}
}